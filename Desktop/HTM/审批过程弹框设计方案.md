# 审批过程弹框设计方案

## 一、功能概述

在"系统外落货纸创建/编辑"页面，点击"审批过程"按钮后，弹出审批流程查询弹框，展示当前落货纸的审批历史记录。

## 二、UI设计

### 2.1 弹框样式
- **参考样式**：参考现有的"批量导入批次"弹框（showImportModal）的样式
- **弹框尺寸**：宽度约 800px，高度自适应（最大高度 80vh）
- **位置**：居中显示，带遮罩层

### 2.2 弹框结构

```
┌─────────────────────────────────────────┐
│  审批过程查询                    [×]     │
├─────────────────────────────────────────┤
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 表格区域                           │  │
│  └───────────────────────────────────┘  │
│                                         │
├─────────────────────────────────────────┤
│                          [关闭]         │
└─────────────────────────────────────────┘
```

### 2.3 表格列设计

| 列名 | 说明 | 宽度 | 对齐方式 |
|------|------|------|----------|
| 落货纸号 | 当前落货纸的单号 | 150px | 左对齐 |
| 序号 | 审批步骤的顺序号 | 60px | 居中 |
| 审批节点名称 | 审批节点的名称 | 150px | 左对齐 |
| 审批人 | 执行审批的人员 | 120px | 左对齐 |
| 动作 | 审批动作（提交审核/通过/驳回/转办） | 120px | 居中 |
| 审批意见 | 审批时的备注意见 | 200px+ | 左对齐 |

### 2.4 表格样式
- **表头**：浅灰色背景（#F1F5F9），字体加粗，12px
- **表格行**：白色背景，鼠标悬停时浅灰色背景（#F8FAFC）
- **边框**：表格边框使用 #E2E8F0
- **行高**：每行高度 40px

## 三、数据结构设计

### 3.1 审批记录数据结构

```javascript
approvalHistory: [
  {
    id: 1,                          // 记录ID
    sequenceNo: 1,                  // 序号
    nodeName: '提交审核',            // 审批节点名称
    approver: 'Wilson',             // 审批人
    action: '提交审核',              // 动作
    comments: '',                   // 审批意见（提交时可能为空）
    actionTime: '2025-12-28 10:00'  // 操作时间
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',      // 或为空（待审批）
    action: '通过',                 // 或 '驳回'、'转办'、''（待处理）
    comments: '审批通过，同意执行',  // 审批意见
    actionTime: '2025-12-28 14:30'  // 或为空（待处理）
  }
]
```

### 3.2 动作类型枚举

```javascript
const ACTION_TYPES = {
  SUBMIT: '提交审核',      // 第一个节点
  APPROVE: '通过',         // 区域经理审核通过
  REJECT: '驳回',          // 区域经理审核驳回
  TRANSFER: '转办',        // 区域经理转办给其他人
  PENDING: ''              // 待处理（空字符串）
}
```

## 四、审批流程逻辑

### 4.1 审批流程节点

**节点1：提交审核**
- **触发时机**：用户点击"提交审核"按钮
- **审批人**：当前登录用户（订单人员）
- **动作**：提交审核
- **状态**：自动完成，无需审批
- **下一节点**：区域经理审核

**节点2：区域经理审核**
- **触发时机**：节点1完成后自动流转
- **审批人**：区域经理（从表单的"区域经理"字段获取）
- **动作**：待处理 → 通过/驳回/转办
- **状态**：需要区域经理操作
- **下一节点**：
  - **通过**：流程结束，状态变为"执行"
  - **驳回**：返回"待提交"状态，订单人员可修改后重新提交
  - **转办**：转办给其他区域经理，**转办后仍回到节点2（区域经理审核）**，由新的区域经理继续审批

### 4.2 状态流转

```
待提交 
  ↓ [提交审核]
提交审核 (节点1: 提交审核)
  ↓ [自动流转]
区域经理审核 (节点2: 区域经理审核)
  ↓ [通过]        ↓ [驳回]        ↓ [转办]
执行           待提交           区域经理审核（转办给其他人，继续节点2）
                                    ↓ [通过/驳回]
                                  执行/待提交
```

### 4.3 审批过程显示规则

#### 规则1：待提交状态
- **显示内容**：空数组 `[]`
- **弹框显示**："暂无审批记录"
- **说明**：用户尚未提交审批，因此没有任何审批记录

#### 规则2：已提交但未审批（提交审核状态）
- **节点1：提交审核**
  - 显示：有记录
  - 动作：**"提交审核"**
  - 审批人：订单人员（如：Wilson）
  - 审批意见：**默认空**（仅用户填写才展示）
  - 动作时间：提交时间（必填）
- **节点2：区域经理审核**
  - 显示：有记录
  - 动作：**"-"**（空，表示未审批）
  - 审批人：**"-"**（空，表示未审批）
  - 审批意见：**"-"**（空，表示未审批）
  - 动作时间：**空字符串**（未审批，无时间）

#### 规则3：区域经理已审批（执行/驳回状态）
- **节点1：提交审核**
  - 显示：有记录
  - 动作：**"提交审核"**
  - 审批人：订单人员
  - 审批意见：**默认空**（仅用户填写才展示）
  - 动作时间：提交时间（必填）
- **节点2：区域经理审核**
  - 显示：有记录
  - 动作：**"通过"** 或 **"驳回"**（具体动作，必填）
  - 审批人：区域经理姓名（必填）
  - 审批意见：区域经理填写的审批意见（可为空；仅填写才展示）
  - 动作时间：**审批时间（必填）**

#### 规则4：区域经理转办
- **节点1：提交审核**
  - 显示：有记录
  - 动作：**"提交审核"**
  - 审批人：订单人员
  - 审批意见：**默认空**（仅用户填写才展示）
  - 动作时间：提交时间（必填）
- **节点2：区域经理审核（第一次）**
  - 显示：有记录
  - 动作：**"转办"**
  - 审批人：原区域经理姓名（必填）
  - 审批意见：转办原因（可为空；仅填写才展示）
  - 动作时间：**转办时间（必填）**
- **节点3：区域经理审核（转办后，新的区域经理）**
  - 显示：有记录（如果转办后新区域经理已审批）
  - 动作：**"通过"** 或 **"驳回"** 或 **"-"**（如果新区域经理还未审批）
  - 审批人：新区域经理姓名 或 **"-"**（如果还未审批）
  - 审批意见：新区域经理的审批意见（可为空；仅填写才展示） 或 **""**（未审批保持空）
  - 动作时间：**审批时间（必填，如果已审批）** 或 **空字符串（如果未审批）**

**重要说明**：
- 转办后，审批流程**仍停留在节点2（区域经理审核）**，不会创建新的审批节点
- 转办操作会在审批历史中记录为一条"转办"记录
- 转办后的审批记录会显示新的区域经理信息
- 如果转办后新区域经理还未审批，则显示为待处理状态（"-"）

### 4.4 数据展示规则

1. **落货纸号**：显示当前表单的 `form.id`（如：LR251230001）
2. **序号**：从1开始递增（转办会创建新的记录，序号递增）
3. **审批节点名称**：
   - 节点1：固定显示"提交审核"
   - 节点2及后续：固定显示"区域经理审核"（转办后仍显示"区域经理审核"）
4. **审批人**：
   - 节点1：显示提交审核的用户（订单人员）
   - 节点2：显示区域经理姓名（如果已审批），否则显示"-"
   - 转办后：显示新的区域经理姓名（如果已审批），否则显示"-"
5. **动作**：
   - 节点1：固定显示"提交审核"
   - 节点2：显示"通过"、"驳回"、"转办"或"-"（待处理）
   - 转办后：显示"通过"、"驳回"或"-"（待处理）
6. **审批意见**：
   - 节点1：通常为空或显示"已提交审核"
   - 节点2：显示区域经理的审批意见，如果未审批则显示"-"
   - 转办时：显示转办原因（可能为空）
7. **动作时间**：
   - 节点1：提交时间（必填）
   - 节点2：审批时间（已审批时必填，未审批时为空字符串）
   - 转办时：转办时间（必填）

## 五、交互设计

### 5.1 按钮点击
- **触发条件**：点击"审批过程"按钮
- **显示条件**：所有状态都可以查看审批过程（包括待提交状态）
- **弹框显示**：`showApprovalModal = true`

### 5.2 数据加载
- **数据来源**：从 `form.approvalHistory` 或模拟数据加载
- **加载时机**：弹框打开时
- **空状态**：如果没有审批记录，显示"暂无审批记录"

### 5.3 关闭弹框
- **方式1**：点击右上角"×"按钮
- **方式2**：点击底部"关闭"按钮
- **方式3**：点击遮罩层（可选）

## 六、实现要点

### 6.1 Vue状态管理

```javascript
// 在 state 中添加
showApprovalModal: false,
approvalHistory: []  // 审批历史记录
```

### 6.2 方法设计

```javascript
// 打开审批过程弹框
const showApprovalProcess = () => {
  // 加载审批历史数据
  loadApprovalHistory();
  state.showApprovalModal = true;
};

// 加载审批历史（模拟数据或API调用）
const loadApprovalHistory = () => {
  // 根据 form.id 和 form.status 生成审批历史
  // 如果状态是"待提交"，只有节点1
  // 如果状态是"提交审核"，有节点1和节点2（节点2待处理）
  // 如果状态是"执行"，有节点1和节点2（节点2已通过）
  // 如果状态是"驳回"，有节点1和节点2（节点2已驳回）
};
```

### 6.3 审批历史生成逻辑

```javascript
// 根据当前状态生成审批历史
const generateApprovalHistory = (form) => {
  const history = [];
  const formatTime = (time) => {
    if (!time) return '';
    return new Date(time).toLocaleString('zh-CN', { 
      year: 'numeric', 
      month: '2-digit', 
      day: '2-digit', 
      hour: '2-digit', 
      minute: '2-digit' 
    }).replace(/\//g, '-');
  };
  
  // 规则1：如果状态是"待提交"，返回空数组
  if (form.status === '待提交' || !form.status) {
    return history; // 空数组，显示"暂无审批记录"
  }
  
  // 规则2：节点1：提交审核（所有已提交的状态都有这个节点）
  if (['提交审核', '执行', '驳回', '转办'].includes(form.status)) {
    history.push({
      id: 1,
      sequenceNo: 1,
      nodeName: '提交审核',
      approver: form.orderPerson || 'Wilson', // 订单人员
      action: '提交审核', // 固定显示"提交审核"
      comments: form.submitComments || '已提交审核', // 通常为空或显示"已提交审核"
      actionTime: form.submitTime || form.lastUpdate || formatTime(new Date()) // 提交时间（必填）
    });
  }
  
  // 规则3：节点2：区域经理审核（所有已提交的状态都有这个节点）
  if (['提交审核', '执行', '驳回', '转办'].includes(form.status)) {
    const node2 = {
      id: 2,
      sequenceNo: 2,
      nodeName: '区域经理审核',
      approver: '',
      action: '',
      comments: '',
      actionTime: ''
    };
    
    if (form.status === '提交审核') {
      // 待处理状态：区域经理还未审批
      node2.approver = '-';
      node2.action = '-'; // 空，表示未审批
      node2.comments = '-';
      node2.actionTime = ''; // 空字符串，未审批无时间
    } else if (form.status === '执行') {
      // 审批通过
      node2.approver = form.regionalManager || '区域经理 张三';
      node2.action = '通过'; // 具体动作：通过
      node2.comments = form.approvalComments || ''; // 审批意见（可能为空）
      node2.actionTime = form.approvalTime || form.lastUpdate || formatTime(new Date()); // 审批时间（必填）
    } else if (form.status === '驳回') {
      // 审批驳回
      node2.approver = form.regionalManager || '区域经理 张三';
      node2.action = '驳回'; // 具体动作：驳回
      node2.comments = form.rejectComments || ''; // 审批意见（可能为空）
      node2.actionTime = form.rejectTime || form.lastUpdate || formatTime(new Date()); // 审批时间（必填）
    } else if (form.status === '转办') {
      // 转办处理
      // 节点2-1：原区域经理的转办记录
      node2.approver = form.originalRegionalManager || form.regionalManager || '区域经理 张三';
      node2.action = '转办'; // 具体动作：转办
      node2.comments = form.transferComments || ''; // 转办原因（可能为空）
      node2.actionTime = form.transferTime || form.lastUpdate || formatTime(new Date()); // 转办时间（必填）
      history.push(node2);
      
      // 节点2-2：转办后的新区域经理审核（转办后仍回到区域经理审核节点）
      const node2AfterTransfer = {
        id: 3,
        sequenceNo: 3,
        nodeName: '区域经理审核', // 转办后仍显示"区域经理审核"
        approver: '',
        action: '',
        comments: '',
        actionTime: ''
      };
      
      // 如果转办后新区域经理已审批
      if (form.transferApprovalStatus === '通过') {
        node2AfterTransfer.approver = form.newRegionalManager || '区域经理 李四';
        node2AfterTransfer.action = '通过';
        node2AfterTransfer.comments = form.transferApprovalComments || '';
        node2AfterTransfer.actionTime = form.transferApprovalTime || formatTime(new Date());
      } else if (form.transferApprovalStatus === '驳回') {
        node2AfterTransfer.approver = form.newRegionalManager || '区域经理 李四';
        node2AfterTransfer.action = '驳回';
        node2AfterTransfer.comments = form.transferRejectComments || '';
        node2AfterTransfer.actionTime = form.transferRejectTime || formatTime(new Date());
      } else {
        // 转办后新区域经理还未审批
        node2AfterTransfer.approver = '-';
        node2AfterTransfer.action = '-'; // 空，表示未审批
        node2AfterTransfer.comments = '-';
        node2AfterTransfer.actionTime = ''; // 空字符串，未审批无时间
      }
      
      history.push(node2AfterTransfer);
      return history; // 转办情况已处理完，直接返回
    }
    
    history.push(node2);
  }
  
  return history;
};
```

### 6.4 关键逻辑说明

1. **待提交状态**：返回空数组 `[]`，弹框显示"暂无审批记录"
2. **提交审核状态**：
   - 节点1：显示"提交审核"动作，有提交时间
   - 节点2：显示"-"（未审批），动作时间为空
3. **执行/驳回状态**：
   - 节点1：显示"提交审核"动作，有提交时间
   - 节点2：显示"通过"或"驳回"动作，**有审批时间（必填）**
4. **转办状态**：
   - 节点1：显示"提交审核"动作，有提交时间
   - 节点2（第一次）：显示"转办"动作，**有转办时间（必填）**
   - 节点3（转办后）：显示"通过"、"驳回"或"-"（未审批），**如果已审批，有审批时间（必填）**
5. **时间字段规则**：
   - 已完成的动作（提交审核、通过、驳回、转办）：**必须有动作时间**
   - 未完成的动作（待审批）：**动作时间为空字符串**

## 七、样式参考

### 7.1 弹框样式（参考现有modal）

```css
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(15, 23, 42, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  backdrop-filter: blur(2px);
}

.modal-content {
  background: white;
  border-radius: 12px;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  width: 800px;
  max-height: 80vh;
  overflow: hidden;
  animation: slideIn 0.2s ease-out;
}
```

### 7.2 表格样式（参考现有htm-table）

```css
.approval-table {
  width: 100%;
  border-collapse: collapse;
}

.approval-table th {
  background-color: #F1F5F9;
  color: #475569;
  font-weight: 600;
  font-size: 12px;
  padding: 10px 12px;
  text-align: left;
  border-bottom: 1px solid #E2E8F0;
}

.approval-table td {
  padding: 10px 12px;
  font-size: 13px;
  border-bottom: 1px solid #F8FAFC;
  color: #334155;
}

.approval-table tr:hover td {
  background-color: #F8FAFC;
}
```

### 7.3 前端样式示例（提交审核 + 区域经理审核通过）

下面是一个**不依赖实际状态计算**的前端静态示例，直接在原型里写死两条记录：  
序号1为“提交审核”，序号2为“区域经理审核-通过”，方便前端/产品直观看到最终样式。

```html
<!-- 审批过程弹框示例（静态写死两条审批记录） -->
<div class="modal-overlay">
  <div class="modal-content">
    <!-- 弹框头部 -->
    <div class="flex items-center justify-between px-4 py-3 border-b border-slate-200">
      <div class="text-sm font-medium text-slate-800">
        审批过程查询
      </div>
      <button type="button" class="text-slate-400 hover:text-slate-600">
        <i class="fas fa-times text-sm"></i>
      </button>
    </div>

    <!-- 弹框内容 -->
    <div class="p-4">
      <div class="border border-slate-200 rounded-lg overflow-hidden">
        <table class="approval-table">
          <thead>
            <tr>
              <th style="width:150px;">落货纸号</th>
              <th style="width:60px; text-align:center;">序号</th>
              <th style="width:150px;">审批节点名称</th>
              <th style="width:120px;">审批人</th>
              <th style="width:120px; text-align:center;">动作</th>
              <th>审批意见</th>
              <th style="width:160px;">动作时间</th>
            </tr>
          </thead>
          <tbody>
            <!-- 序号1：提交审核 -->
            <tr>
              <td>LR251230001</td>
              <td style="text-align:center;">1</td>
              <td>提交审核</td>
              <td>Wilson</td>
              <td style="text-align:center;">提交审核</td>
              <td>已提交审核</td>
              <td>2025-12-28 10:00</td>
            </tr>
            <!-- 序号2：区域经理审核-通过 -->
            <tr>
              <td>LR251230001</td>
              <td style="text-align:center;">2</td>
              <td>区域经理审核</td>
              <td>区域经理 张三</td>
              <td style="text-align:center;">通过</td>
              <td>审批通过，同意执行</td>
              <td>2025-12-28 14:30</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- 弹框底部 -->
    <div class="px-4 py-3 border-t border-slate-200 flex justify-end">
      <button type="button"
              class="px-4 py-1.5 text-xs rounded border border-slate-300 text-slate-700 hover:bg-slate-50">
        关闭
      </button>
    </div>
  </div>
</div>
```

## 八、审批过程案例

### 案例1：待提交状态（用户未提交审批）

**表单状态**：`待提交`

**审批过程显示**：
```
暂无审批记录
```

**数据结构**：
```javascript
approvalHistory: []  // 空数组，显示"暂无审批记录"
```

**说明**：用户尚未提交审批，因此没有任何审批记录。

---

### 案例2：提交审核状态（用户已提交，区域经理未审批）

**表单状态**：`提交审核`

**审批过程显示**：
| 落货纸号 | 序号 | 审批节点名称 | 审批人 | 动作 | 审批意见 | 动作时间 |
|---------|------|------------|--------|------|---------|---------|
| LR251230001 | 1 | 提交审核 | Wilson | 提交审核 | 已提交审核 | 2025-12-28 10:00 |
| LR251230001 | 2 | 区域经理审核 | - | - | - | - |

**数据结构**：
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',  // 用户提交审批，动作是"提交审核"
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'  // 有提交时间
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '-',  // 区域经理还未审批，显示"-"
    action: '-',    // 区域经理还未审批，动作显示"-"
    comments: '-',  // 区域经理还未审批，意见显示"-"
    actionTime: ''  // 区域经理还未审批，动作时间为空字符串
  }
]
```

**说明**：
- 节点1：用户已提交审批，动作是"提交审核"，有提交时间
- 节点2：区域经理还未审批，所有字段显示"-"，动作时间为空

---

### 案例3：执行状态（区域经理审批通过）

**表单状态**：`执行`

**审批过程显示**：
| 落货纸号 | 序号 | 审批节点名称 | 审批人 | 动作 | 审批意见 | 动作时间 |
|---------|------|------------|--------|------|---------|---------|
| LR251230001 | 1 | 提交审核 | Wilson | 提交审核 | 已提交审核 | 2025-12-28 10:00 |
| LR251230001 | 2 | 区域经理审核 | 区域经理 张三 | 通过 | 审批通过，同意执行 | 2025-12-28 14:30 |

**数据结构**：
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '通过',  // 区域经理已审批，动作是"通过"
    comments: '审批通过，同意执行',
    actionTime: '2025-12-28 14:30'  // 有审批时间（必填）
  }
]
```

**说明**：
- 节点1：用户已提交审批，有提交时间
- 节点2：区域经理已审批通过，动作是"通过"，**有审批时间（必填）**

---

### 案例4：驳回状态（区域经理审批驳回）

**表单状态**：`驳回`

**审批过程显示**：
| 落货纸号 | 序号 | 审批节点名称 | 审批人 | 动作 | 审批意见 | 动作时间 |
|---------|------|------------|--------|------|---------|---------|
| LR251230001 | 1 | 提交审核 | Wilson | 提交审核 | 已提交审核 | 2025-12-28 10:00 |
| LR251230001 | 2 | 区域经理审核 | 区域经理 张三 | 驳回 | 信息不完整，请补充后再提交 | 2025-12-28 14:30 |

**数据结构**：
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '驳回',  // 区域经理已审批，动作是"驳回"
    comments: '信息不完整，请补充后再提交',
    actionTime: '2025-12-28 14:30'  // 有审批时间（必填）
  }
]
```

**说明**：
- 节点1：用户已提交审批，有提交时间
- 节点2：区域经理已审批驳回，动作是"驳回"，**有审批时间（必填）**

---

### 案例5：转办状态（区域经理转办给其他人，新区域经理已审批通过）

**表单状态**：`转办` → `执行`（转办后新区域经理审批通过）

**审批过程显示**：
| 落货纸号 | 序号 | 审批节点名称 | 审批人 | 动作 | 审批意见 | 动作时间 |
|---------|------|------------|--------|------|---------|---------|
| LR251230001 | 1 | 提交审核 | Wilson | 提交审核 | 已提交审核 | 2025-12-28 10:00 |
| LR251230001 | 2 | 区域经理审核 | 区域经理 张三 | 转办 | 转办给李四处理 | 2025-12-28 11:00 |
| LR251230001 | 3 | 区域经理审核 | 区域经理 李四 | 通过 | 审批通过，同意执行 | 2025-12-28 15:00 |

**数据结构**：
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '转办',  // 原区域经理转办
    comments: '转办给李四处理',
    actionTime: '2025-12-28 11:00'  // 有转办时间（必填）
  },
  {
    id: 3,
    sequenceNo: 3,
    nodeName: '区域经理审核',  // 转办后仍显示"区域经理审核"
    approver: '区域经理 李四',  // 新区域经理
    action: '通过',  // 新区域经理已审批，动作是"通过"
    comments: '审批通过，同意执行',
    actionTime: '2025-12-28 15:00'  // 有审批时间（必填）
  }
]
```

**说明**：
- 节点1：用户已提交审批，有提交时间
- 节点2：原区域经理转办，动作是"转办"，**有转办时间（必填）**
- 节点3：转办后新区域经理审批，**转办后仍回到区域经理审核节点**，动作是"通过"，**有审批时间（必填）**

---

### 案例6：转办状态（区域经理转办给其他人，新区域经理还未审批）

**表单状态**：`转办`（转办后新区域经理还未审批）

**审批过程显示**：
| 落货纸号 | 序号 | 审批节点名称 | 审批人 | 动作 | 审批意见 | 动作时间 |
|---------|------|------------|--------|------|---------|---------|
| LR251230001 | 1 | 提交审核 | Wilson | 提交审核 | 已提交审核 | 2025-12-28 10:00 |
| LR251230001 | 2 | 区域经理审核 | 区域经理 张三 | 转办 | 转办给李四处理 | 2025-12-28 11:00 |
| LR251230001 | 3 | 区域经理审核 | - | - | - | - |

**数据结构**：
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '转办',
    comments: '转办给李四处理',
    actionTime: '2025-12-28 11:00'  // 有转办时间（必填）
  },
  {
    id: 3,
    sequenceNo: 3,
    nodeName: '区域经理审核',  // 转办后仍显示"区域经理审核"
    approver: '-',  // 新区域经理还未审批，显示"-"
    action: '-',    // 新区域经理还未审批，动作显示"-"
    comments: '-',  // 新区域经理还未审批，意见显示"-"
    actionTime: ''  // 新区域经理还未审批，动作时间为空字符串
  }
]
```

**说明**：
- 节点1：用户已提交审批，有提交时间
- 节点2：原区域经理转办，动作是"转办"，**有转办时间（必填）**
- 节点3：转办后新区域经理还未审批，所有字段显示"-"，动作时间为空

---

## 九、示例数据（快速参考）

### 9.1 待提交状态
```javascript
approvalHistory: []  // 空数组，显示"暂无审批记录"
```

### 9.2 提交审核状态
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '-',
    action: '-',
    comments: '-',
    actionTime: ''
  }
]
```

### 9.3 执行状态
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '通过',
    comments: '审批通过，同意执行',
    actionTime: '2025-12-28 14:30'
  }
]
```

### 9.4 驳回状态
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '驳回',
    comments: '信息不完整，请补充后再提交',
    actionTime: '2025-12-28 14:30'
  }
]
```

### 9.5 转办状态（新区域经理已审批）
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '转办',
    comments: '转办给李四处理',
    actionTime: '2025-12-28 11:00'
  },
  {
    id: 3,
    sequenceNo: 3,
    nodeName: '区域经理审核',
    approver: '区域经理 李四',
    action: '通过',
    comments: '审批通过，同意执行',
    actionTime: '2025-12-28 15:00'
  }
]
```

### 9.6 转办状态（新区域经理未审批）
```javascript
approvalHistory: [
  {
    id: 1,
    sequenceNo: 1,
    nodeName: '提交审核',
    approver: 'Wilson',
    action: '提交审核',
    comments: '已提交审核',
    actionTime: '2025-12-28 10:00'
  },
  {
    id: 2,
    sequenceNo: 2,
    nodeName: '区域经理审核',
    approver: '区域经理 张三',
    action: '转办',
    comments: '转办给李四处理',
    actionTime: '2025-12-28 11:00'
  },
  {
    id: 3,
    sequenceNo: 3,
    nodeName: '区域经理审核',
    approver: '-',
    action: '-',
    comments: '-',
    actionTime: ''
  }
]
```

## 十、关键规则总结

### 10.1 显示规则

1. **待提交状态**：
   - 返回空数组 `[]`
   - 弹框显示"暂无审批记录"
   - **原因**：用户尚未提交审批，因此没有任何审批记录

2. **已提交但未审批（提交审核状态）**：
   - 节点1：显示"提交审核"动作，**有提交时间（必填）**
   - 节点2：所有字段显示"-"，**动作时间为空字符串**

3. **已审批（执行/驳回状态）**：
   - 节点1：显示"提交审核"动作，有提交时间
   - 节点2：显示"通过"或"驳回"动作，**有审批时间（必填）**

4. **转办状态**：
   - 节点1：显示"提交审核"动作，有提交时间
   - 节点2：显示"转办"动作，**有转办时间（必填）**
   - 节点3：转办后仍回到"区域经理审核"节点
     - 如果新区域经理已审批：显示"通过"或"驳回"，**有审批时间（必填）**
     - 如果新区域经理未审批：所有字段显示"-"，**动作时间为空字符串**

### 10.2 时间字段规则

- **已完成的动作**（提交审核、通过、驳回、转办）：**必须有动作时间**
- **未完成的动作**（待审批）：**动作时间为空字符串**

### 10.3 转办逻辑

- **转办后，审批流程仍停留在节点2（区域经理审核）**，不会创建新的审批节点类型
- 转办操作会在审批历史中记录为一条"转办"记录
- 转办后的审批记录会显示新的区域经理信息
- 如果转办后新区域经理还未审批，则显示为待处理状态（"-"）

## 十一、注意事项

1. **数据一致性**：审批历史应该与表单状态保持一致
2. **时间显示**：操作时间格式统一为 "YYYY-MM-DD HH:mm"
3. **空值处理**：未审批的节点显示"-"而不是空白
4. **时间必填规则**：
   - 已完成的动作（提交审核、通过、驳回、转办）：**必须有动作时间**
   - 未完成的动作（待审批）：**动作时间为空字符串**
5. **权限控制**：所有用户都可以查看审批过程（只读）
6. **响应式设计**：弹框在小屏幕上应该自适应宽度

## 十二、后续扩展

如果未来需要多级审批，可以：
1. 扩展 `approvalHistory` 数组，添加更多节点
2. 在"动作"列中支持更多操作类型
3. 添加"转办"功能的详细展示（转办给谁、转办原因等）
4. 支持多次转办（转办给A，A再转办给B）
